<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Admin â€” Exports</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container layout">
    <aside class="sidebar">
      <h2 class="brand">DONS Admin</h2>
      <nav>
        <a href="dashboard.html">Tableau de bord</a>
        <a href="admin_groups.html">Groupes</a>
        <a href="admin_members.html">Membres</a>
        <a class="active" href="admin_exports.html">Exports</a>
        <a href="admin_payments.html">Paiements</a>
      </nav>
    </aside>
    <div class="content card">
      <div class="header">
        <h1 class="title">Exports & Rapports</h1>
      </div>
      <div class="grid">
        <div class="row">
          <button id="exportExcel">Exporter Excel</button>
          <button id="exportPDF">Exporter PDF</button>
          <button id="exportCSV">Exporter CSV</button>
        </div>
        <div class="row">
          <button id="reportMembers">Rapport Membres</button>
          <button id="reportContribs">Rapport Cotisations</button>
          <button id="reportGroups">Rapport Groupes</button>
        </div>
        <div id="result" class="muted"></div>
        <div id="error" class="muted" style="color:#ef4444"></div>
      </div>
    </div>
  </div>
  <script src="api.js"></script>
  <script>
    const result = document.getElementById('result');
    const errorEl = document.getElementById('error');
    async function call(fn){
      result.textContent=''; errorEl.textContent='';
      try{ const res = await fn(); result.textContent = JSON.stringify(res).slice(0,800); }
      catch(e){ errorEl.textContent = e?.data?.message || e.message; }
    }
    document.getElementById('exportExcel').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.exportExcel()));
    document.getElementById('exportPDF').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.exportPDF()));
    document.getElementById('exportCSV').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.exportCSV()));
    document.getElementById('reportMembers').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.reportMembers()));
    document.getElementById('reportContribs').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.reportContributions()));
    document.getElementById('reportGroups').addEventListener('click', ()=>call(()=>DonsApi.AdminApi.reportGroups()));
  </script>
</body>
</html>


